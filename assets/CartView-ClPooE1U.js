import{a as w,S as b}from"./sweetalert2.all-lMQcd3on.js";import{_ as L,f as x,m as q,r as i,o as d,c as r,b as n,a as e,F as f,h as E,t as _,w as U,j as S,k as A,d as I,g as v,l as y,n as p}from"./index-2ZTvRUip.js";import{c as g}from"./cartStore-spUwWhBu.js";var D={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"dorayu",BASE_URL:"/vite-deploy-week06/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:M,VITE_PATH:T}=D,F={data(){return{form:{data:{user:{name:"",email:"",tel:"",address:""},message:""}}}},computed:{...x(g,["cartList","status","isLoading"])},methods:{...q(g,["getCarts","deleteAllCarts","removeCartItem","updateCart"]),fetchDeleteAllCarts(){this.deleteAllCarts()},fetchRemoveCartItem(s){this.removeCartItem(s)},fetchUpdateCart(s){this.updateCart(s)},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"},createOrder(){const s=`${M}/api/${T}/order`,{form:a}=this;this.cartList.length!==0&&w.post(s,a).then(c=>{b.fire(c.data.message),this.$refs.form.resetForm(),this.getCarts()}).catch(c=>{b.fire(c.response.data.message)})}},mounted(){this.getCarts()}},B=e("h2",null,"購物車",-1),N={class:"container"},R={class:"mt-4"},z={class:"text-end"},H={key:0,class:"bg-light my-4 p-4"},P={class:"table align-middle"},O=e("thead",null,[e("tr",null,[e("th"),e("th",null,"圖片"),e("th",null,"品名"),e("th",{style:{width:"150px"}},"數量/單位"),e("th",{class:"text-end"},"單價")])],-1),Q=["disabled","onClick"],j=["src"],G={class:"input-group input-group-sm"},J={class:"input-group mb-3"},K=["disabled","onClick"],W=["onClick"],X=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[e("path",{d:`M5.5 5.5A.5.5 0 0 1 6
                    6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1
                    0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z`}),e("path",{d:`M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0
                    1-2-2V4h-.5a1 1 0 0 1-1-1V2a1
                    1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4
                    4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z`})],-1),Y=[X],Z=["onUpdate:modelValue","disabled"],$=["disabled","onClick"],ee={class:"text-end"},te=e("td",{colspan:"4",class:"text-end"},"總計",-1),se={class:"text-end"},ae=e("td",{colspan:"4",class:"text-end text-success"},"折扣價",-1),le={class:"text-end text-success"},oe={key:1,class:"bg-light my-4 p-4"},ne={class:"my-5 row justify-content-center"},de={class:"mb-3"},re=e("label",{for:"email",class:"form-label"},"Email",-1),ie={class:"mb-3"},ce=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),me={class:"mb-3"},ue=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),he={class:"mb-3"},_e=e("label",{for:"address",class:"form-label"},"收件人地址",-1),pe={class:"mb-3"},be=e("label",{for:"message",class:"form-label"},"留言",-1),fe=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-primary"},"Submit")],-1);function ve(s,a,c,ye,o,m){const V=i("VueLoading"),C=i("font-awesome-icon"),u=i("VField"),h=i("ErrorMessage"),k=i("VForm");return d(),r(f,null,[n(V,{active:s.isLoading},null,8,["active"]),B,e("div",N,[e("div",R,[e("div",z,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...t)=>m.fetchDeleteAllCarts&&m.fetchDeleteAllCarts(...t))},"清空購物車")]),s.cartList.carts&&s.cartList.carts.length>0?(d(),r("div",H,[e("table",P,[O,e("tbody",null,[(d(!0),r(f,null,E(s.cartList.carts,t=>(d(),r("tr",{key:t.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:t.id===s.status.loadQty,onClick:l=>s.removeCartItem(t.id)},[t.id===s.status.loadQty?(d(),S(C,{key:0,icon:["fas","spinner"],"spin-pulse":""})):A("",!0),I(" x ")],8,Q)]),e("td",null,[e("img",{class:"img-cart",src:t.product.imageUrl,alt:""},null,8,j)]),e("td",null,_(t.product.title),1),e("td",null,[e("div",G,[e("div",J,[t.qty>1?(d(),r("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm",disabled:t.qty===1,onClick:l=>{t.qty--,s.updateCart(t,t.qty)}}," - ",8,K)):(d(),r("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm",onClick:l=>s.removeCartItem(t.id)},Y,8,W)),v(e("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":l=>t.qty=l,disabled:t.id===s.status.loadQty,readonly:""},null,8,Z),[[y,t.qty,void 0,{number:!0}]]),e("button",{type:"button",class:"btn btn-outline-primary btn-sm",disabled:t.qty===20,onClick:l=>{t.qty++,s.updateCart(t,t.qty)}}," + ",8,$)])])]),e("td",ee,_(t.final_total),1)]))),128))]),e("tfoot",null,[e("tr",null,[te,e("td",se,_(s.cartList.total),1)]),e("tr",null,[ae,e("td",le,_(s.cartList.final_total),1)])])])])):(d(),r("div",oe,"購物車沒有任何品項"))]),e("div",ne,[n(k,{onSubmit:m.createOrder,ref:"form",class:"col-md-6"},{default:U(({errors:t})=>[e("div",de,[re,n(u,{type:"email",class:p(["form-control",{"is-invalid":t.email}]),id:"email",name:"email",placeholder:"請輸入Email",rules:"email|required",modelValue:o.form.data.user.email,"onUpdate:modelValue":a[1]||(a[1]=l=>o.form.data.user.email=l)},null,8,["class","modelValue"]),n(h,{class:"invalid-feedback",name:"email"})]),e("div",ie,[ce,n(u,{type:"text",class:p(["form-control",{"is-invalid":t.name}]),id:"name",name:"name",placeholder:"請輸入姓名",rules:"required",modelValue:o.form.data.user.name,"onUpdate:modelValue":a[2]||(a[2]=l=>o.form.data.user.name=l)},null,8,["class","modelValue"]),n(h,{class:"invalid-feedback",name:"name"})]),e("div",me,[ue,n(u,{type:"text",class:p(["form-control",{"is-invalid":t.tel}]),id:"tel",name:"tel",placeholder:"請輸入電話",rules:m.isPhone,modelValue:o.form.data.user.tel,"onUpdate:modelValue":a[3]||(a[3]=l=>o.form.data.user.tel=l)},null,8,["class","rules","modelValue"]),n(h,{class:"invalid-feedback",name:"tel"})]),e("div",he,[_e,n(u,{type:"text",class:p(["form-control",{"is-invalid":t.address}]),id:"address",name:"address",placeholder:"請輸入地址",rules:"required",modelValue:o.form.data.user.address,"onUpdate:modelValue":a[4]||(a[4]=l=>o.form.data.user.address=l)},null,8,["class","modelValue"]),n(h,{class:"invalid-feedback",name:"address"})]),e("div",pe,[be,v(e("textarea",{name:"message",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":a[5]||(a[5]=l=>o.form.data.message=l)},null,512),[[y,o.form.data.message]])]),fe]),_:1},8,["onSubmit"])])])],64)}const ke=L(F,[["render",ve]]);export{ke as default};
